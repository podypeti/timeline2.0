
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>History Timeline</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script href='./style.css'></script>
</head>
<body>

  <!-- Timeline Canvas -->
  <div id="timelineContainer">
    <canvas id="timelineCanvas" width="1200" height="560" aria-label="Timeline"></canvas>
  </div>

  <!-- Legend / Filters -->
  <div class="legendControls">
    <div class="inner">
      <details class="legend-panel" open>
        <summary>Categories</summary>
        <div class="legend-content">
          <input id="legendSearch" type="search" placeholder="Search categories…" />
          <div class="chip-row">
            <div class="chip" data-admin="all"><span class="swatch green"></span>All</div>
            <div class="chip" data-admin="none"><span class="swatch red"></span>None</div>
          </div>
          <div id="legend"></div>
        </div>
      </details>
      <div class="spacer"></div>
      <button id="zoomOut" class="ghost">−</button>
      <button id="resetZoom" class="ghost">Reset</button>
      <button id="zoomIn" class="ghost">+</button>
    </div>
  </div>

  <!-- Details Panel -->
  <aside id="detailsPanel" class="details hidden" role="dialog" aria-modal="true">
    <button id="detailsClose" class="close" aria-label="Close">×</button>
    <div id="detailsContent"></div>
  </aside>

  <!-- Pan Slider -->
  <div class="panSliderBar">
    <span class="panLabel">Center:</span>
    <input id="panSlider" type="range" />
    <span id="panValue" class="panValue">1 CE</span>
  </div>

  <!-- Scripts -->
  <script src="./timeline.js"></script>
  <script>
    // === Configure your CSV path here ===
    const CSV_URL = './timeline-data.csv'; 
    // If hosted on GitHub raw:
    // const CSV_URL = 'https://raw.githubusercontent.com/<user>/<repo>/<branch>/timeline/data/events.csv';

    async function start() {
      try {
        const rows = await loadCsv(CSV_URL);    // parse CSV -> array of objects
        events = rows;                          // provide data to the timeline
        buildLegend();                          // build category chips
        initScaleAndPan();                      // compute scale + center
        draw();                                 // first render
      } catch (err) {
        console.error('[timeline] failed to load CSV', err);
        const panel = document.getElementById('detailsPanel');
        const content = document.getElementById('detailsContent');
        content.innerHTML = '<p><strong>Error:</strong> Could not load CSV. Check URL and CORS.</p>';
        panel.classList.remove('hidden');
      }
    };
  </script>
</body>
</html>
